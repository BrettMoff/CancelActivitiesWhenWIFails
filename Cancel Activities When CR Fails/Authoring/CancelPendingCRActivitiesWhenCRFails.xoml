<SequentialWorkflowActivity x:Class="WorkflowAuthoring.CancelPendingCRActivitiesWhenCRFails" x:Name="CancelPendingCRActivitiesWhenCRFails" xmlns:ns0="clr-namespace:Microsoft.ServiceManager.WorkflowAuthoring.ActivityLibrary;Assembly=Microsoft.ServiceManager.WorkflowAuthoring.ActivityLibrary, Version=7.0.5000.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow">
	<ns0:WindowsPowerShellScript x:Name="CancelCRActivities" ScriptBody="import-module smlets&#xD;&#xA;$InProgress = Get-SCSMEnumeration -Name ActivityStatusEnum.Ready&#xD;&#xA;$Cancelled = Get-SCSMEnumeration -Name ActivityStatusEnum.Cancelled&#xD;&#xA;$ChangeRequest = Get-SCSMObject -Class (Get-SCSMClass -Name System.WorkItem.ChangeRequest$) -Filter &quot;Id -eq $ChangeRequestID&quot;&#xD;&#xA;$ChildActivities = (Get-SCSMRelationshipObject -BySource $ChangeRequest | ?{$_.RelationshipID -eq &quot;2DA498BE-0485-B2B2-D520-6EBD1698E61B&quot;})&#xD;&#xA;$ChildActivities | %{$Activity = Get-SCSMObject -ID $_.TargetObject.Id; if($Activity.Status -eq $InProgress){$Activity | Set-SCSMObject -Property Status -Value $Cancelled}}" TaskID="CancelPendingCRActivitiesWhenCRFails.WindowsPowerShellScript.73a4d3ae_4c35_4769_b912_266e78876e5c" Description="Cancel all pending child activities of the targeted CR" SnapIns="{x:Null}" ScriptName="{x:Null}" PropertyToBind="{x:Null}" Parameter="{x:Null}">
		<ns0:WindowsPowerShellScript.Parameters>
			<x:Array Type="{x:Type p7:ActivityParameter}" xmlns:p7="clr-namespace:Microsoft.ServiceManager.WorkflowAuthoring.Common;Assembly=Microsoft.ServiceManager.WorkflowAuthoring.Common, Version=7.0.5000.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35">
				<ns1:ActivityParameter Key="ChangeRequestID" Value="Activity=CancelPendingCRActivitiesWhenCRFails, Path=windowsPowerShellScript1_ChangeRequestID" BindPath="{ActivityBind CancelPendingCRActivitiesWhenCRFails,Path=windowsPowerShellScript1_ChangeRequestID}" xmlns:ns1="clr-namespace:Microsoft.ServiceManager.WorkflowAuthoring.Common;Assembly=Microsoft.ServiceManager.WorkflowAuthoring.Common, Version=7.0.5000.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
			</x:Array>
		</ns0:WindowsPowerShellScript.Parameters>
	</ns0:WindowsPowerShellScript>
</SequentialWorkflowActivity>