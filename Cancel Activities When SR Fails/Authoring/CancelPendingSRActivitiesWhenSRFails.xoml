<SequentialWorkflowActivity x:Class="WorkflowAuthoring.CancelPendingSRActivitiesWhenSRFails" x:Name="CancelPendingSRActivitiesWhenSRFails" xmlns:ns0="clr-namespace:Microsoft.ServiceManager.WorkflowAuthoring.ActivityLibrary;Assembly=Microsoft.ServiceManager.WorkflowAuthoring.ActivityLibrary, Version=7.0.5000.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow">
	<ns0:WindowsPowerShellScript x:Name="CancelSRActivities" ScriptBody="import-module smlets&#xD;&#xA;$InProgress = Get-SCSMEnumeration -Name ActivityStatusEnum.Ready&#xD;&#xA;&#xD;&#xA;$Cancelled = Get-SCSMEnumeration -Name ActivityStatusEnum.Cancelled&#xD;&#xA;&#xD;&#xA;$ServiceRequest = Get-SCSMObject -Class (Get-SCSMClass -Name System.WorkItem.ServiceRequest$) -Filter &quot;Id -eq $ServiceRequestID&quot;&#xD;&#xA;&#xD;&#xA;$ChildActivities = (Get-SCSMRelationshipObject -BySource $ServiceRequest | ?{$_.RelationshipID -eq &quot;2da498be-0485-b2b2-d520-6ebd1698e61b&quot;})&#xD;&#xA;&#xD;&#xA;$ChildActivities | %{$Activity = Get-SCSMObject -ID $_.TargetObject.Id; if($Activity.Status -eq $InProgress){$Activity | Set-SCSMObject -Property Status -Value $Cancelled}}" TaskID="CancelPendingSRActivitiesWhenSRFails.WindowsPowerShellScript.95049425_04ab_4b46_b151_12d0810d25b3" Description="Cancel all pending child activities of the targeted SR" SnapIns="{x:Null}" ScriptName="{x:Null}" PropertyToBind="{x:Null}" Parameter="{x:Null}">
		<ns0:WindowsPowerShellScript.Parameters>
			<x:Array Type="{x:Type p7:ActivityParameter}" xmlns:p7="clr-namespace:Microsoft.ServiceManager.WorkflowAuthoring.Common;Assembly=Microsoft.ServiceManager.WorkflowAuthoring.Common, Version=7.0.5000.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35">
				<ns1:ActivityParameter Key="ServiceRequestID" Value="Activity=CancelSRActivities, Path=ScriptBody" BindPath="{x:Null}" xmlns:ns1="clr-namespace:Microsoft.ServiceManager.WorkflowAuthoring.Common;Assembly=Microsoft.ServiceManager.WorkflowAuthoring.Common, Version=7.0.5000.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
			</x:Array>
		</ns0:WindowsPowerShellScript.Parameters>
	</ns0:WindowsPowerShellScript>
</SequentialWorkflowActivity>